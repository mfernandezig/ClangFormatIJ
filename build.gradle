plugins {
    id 'java'
    id 'org.jetbrains.kotlin.jvm' version '1.8.21'
    id 'org.jetbrains.intellij' version '1.13.3'
}

group = 'io.probst.idea.clangformat'
version = '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
     compileOnly 'org.projectlombok:lombok:1.18.26'
     annotationProcessor 'org.projectlombok:lombok:1.18.26'
}

intellij {
    version = '2022.2.5'
    type = 'IC'

    plugins = [] // Plugin Dependencies
}

tasks.withType(JavaCompile) {
    sourceCompatibility = '17'
    targetCompatibility = '17'
}

tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile) {
    kotlinOptions.jvmTarget = '17'
}

tasks.patchPluginXml {
    sinceBuild = '222'
    untilBuild = '232.*'
}

tasks.signPlugin {
    certificateChain = System.getenv('CERTIFICATE_CHAIN')
    privateKey = System.getenv('PRIVATE_KEY')
    password = System.getenv('PRIVATE_KEY_PASSWORD')
}

tasks.publishPlugin {
    token = System.getenv('PUBLISH_TOKEN')
}
